<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<th:block th:fragment="footer-style-one">

  <script th:if="${theme.config.footer.footerContent.style_one.runtime_enable}" async="async">
    (function () {
      // è®¾ç½®ç½‘ç«™ä¸Šçº¿æ—¶é—´
      var grt = new Date("[[${#strings.arraySplit(theme.config.basics.siteStartTime, '-')[1]}]]/[[${#strings.arraySplit(theme.config.basics.siteStartTime, '-')[2]}]]/[[${#strings.arraySplit(theme.config.basics.siteStartTime, '-')[0]}]] 00:00:00");
      var now = new Date();
      var dnum, hnum, mnum, snum, nowHour, t, n;

      // è®¡ç®—å„é¡¹æ—¶é—´ & æ—…è¡Œè€…1å·
      function updateTime() {
        now = new Date();
        nowHour = now.getHours();

        var days = (now - grt) / 1000 / 60 / 60 / 24;
        dnum = Math.floor(days);

        var hours = (now - grt) / 1000 / 60 / 60 - 24 * dnum;
        hnum = Math.floor(hours);
        if (String(hnum).length === 1) hnum = "0" + hnum;

        var minutes = (now - grt) / 1000 / 60 - 24 * 60 * dnum - 60 * hnum;
        mnum = Math.floor(minutes);
        if (String(mnum).length === 1) mnum = "0" + mnum;

        var seconds = (now - grt) / 1000 - 24 * 60 * 60 * dnum - 60 * 60 * hnum - 60 * mnum;
        snum = Math.round(seconds);
        if (String(snum).length === 1) snum = "0" + snum;

        // æ—…è¡Œè€…1å·è·ç¦»ï¼ˆåŸæœ‰å…¬å¼ï¼‰
        t = Math.trunc(234e8 + (now - grt) / 1e3 * 17);
        n = (t / 1496e5).toFixed(6);
      }

      // æ›´æ–°é¡µé¢ HTML
      function updateHtml() {
        const footer = document.getElementById("footer");
        if (!footer) return;

        let img = "", description = "";
        // ç™½å¤©(ä¸Šç­æ—¶é—´) / å¤œæ™š(ä¸‹ç­æ—¶é—´)
        if (nowHour < 18 && nowHour >= 9) {
          img = "[(${theme.config.footer.footerContent.style_one.work_img})]";
          description = "[(${theme.config.footer.footerContent.style_one.work_description})]";
        } else {
          img = "[(${theme.config.footer.footerContent.style_one.offduty_img})]";
          description = "[(${theme.config.footer.footerContent.style_one.offduty_description})]";
        }

        // ä»…åœ¨ç™½å¤©ç»™æ•´å—æ–‡å­—åŠ è“è‰²ï¼›å¤œæ™šä¸åŠ æ ·å¼ï¼Œèµ°ä¸»é¢˜é»˜è®¤è‰²
        const colorStyle = (nowHour < 18 && nowHour >= 9) ? ' style="color:#22a6c9;"' : '';

        if (document.getElementById("workboard")) {
          const currentTimeHtml = `
            <img class="workSituationImg boardsign" src="${img}" alt="${description}" title="${description}">
            <div id="runtimeTextTip"${colorStyle}>
              æœ¬ç«™è‹Ÿå»¶æ®‹å–˜äº† ${dnum} å¤©
              <span id="runtime"> ${hnum} å°æ—¶ ${mnum} åˆ† ${snum} ç§’ </span>
              <i class="haofont hao-icon-heartbeat" style="color:red"></i>
              <br>
              æ—…è¡Œè€… 1 å·å½“å‰è·ç¦»åœ°çƒ ${t} åƒç±³ï¼Œçº¦ä¸º ${n} ä¸ªå¤©æ–‡å•ä½ ğŸš€
            </div>
          `;
          document.getElementById("workboard").innerHTML = currentTimeHtml;
        }
      }

      // å®šæ—¶åˆ·æ–°
      setInterval(function () {
        updateTime();
        updateHtml();
      }, 1000);
    })();
  </script>

</th:block>

</html>
