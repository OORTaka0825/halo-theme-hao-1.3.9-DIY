<th:block th:fragment="nav-menu-recursion(menuItem)">
    <!-- 有子菜单则显示子菜单 -->
    <th:block th:if="${not #lists.isEmpty(menuItem.children)}">
        <!-- 子菜单 -->
        <div class="menus_item_child"
             th:classappend="${#annotations.get(menuItem,'isVertical')=='1' ? 'vertical_nav' : ''}">
            <div class="recursion_menus_item" th:each="childMenu : ${menuItem.children}">
                <a class="site-page child" th:target="${childMenu.spec.target?.value}"
                   th:href="@{${childMenu.status.href}}">
                    <!-- 开关开启时渲染图标；关闭则不渲染任何图标 -->
                    <th:block th:if="${theme.config.nav.menus.enable_ali_iconfont_symbol_header == 'true' or theme.config.nav.menus.enable_ali_iconfont_symbol_header == true}">
                        <svg class="ali_icon" aria-hidden="true">
                            <use th:attr="href=${#annotations.getOrDefault(childMenu, 'icon', '#icon-default')}"></use>
                        </svg>
                    </th:block>
                    <span th:text="${childMenu.status.displayName}"></span>
                </a>
                <!-- 递归调用 -->
                <div th:replace="~{modules/widgets/nav-menu :: nav-menu-recursion(menuItem=${childMenu})}"></div>
            </div>
        </div>
    </th:block>
</th:block>

<!-- 导航栏菜单栏 -->
<div id="menus" th:fragment="nav-menu">
    <div class="menus_items">

        <!-- 第一层仅展示使用，不做跳转 -->
        <div class="menus_item" th:each="menuItem : ${menuFinder.getPrimary().menuItems}">

            <!-- 无子菜单：可跳转 -->
            <a class="site-page" rel="external nofollow"
               th:if="${#lists.isEmpty(menuItem.children)}"
               th:target="${menuItem.spec.target?.value}"
               th:href="@{${menuItem.status.href}}">
                <!-- 开关开启时渲染图标；关闭则不渲染任何图标 -->
                <th:block th:if="${theme.config.nav.menus.enable_ali_iconfont_symbol_header == 'true' or theme.config.nav.menus.enable_ali_iconfont_symbol_header == true}">
                    <svg class="ali_icon" aria-hidden="true">
                        <use th:attr="href=${#annotations.getOrDefault(menuItem, 'icon', '#icon-default')}"></use>
                    </svg>
                </th:block>
                <span th:text="${menuItem.status.displayName}"></span>
            </a>

            <!-- 有子菜单：不跳转 -->
            <a th:if="${not #lists.isEmpty(menuItem.children)}" class="site-page" rel="external nofollow">
                <!-- 开关开启时渲染图标；关闭则不渲染任何图标 -->
                <th:block th:if="${theme.config.nav.menus.enable_ali_iconfont_symbol_header == 'true' or theme.config.nav.menus.enable_ali_iconfont_symbol_header == true}">
                    <svg class="ali_icon" aria-hidden="true">
                        <use th:attr="href=${#annotations.getOrDefault(menuItem, 'icon', '#icon-default')}"></use>
                    </svg>
                </th:block>
                <span th:text="${menuItem.status.displayName}"></span>
            </a>

            <!-- 递归调用 -->
            <div th:replace="~{modules/widgets/nav-menu :: nav-menu-recursion(menuItem=${menuItem})}"></div>

            <style type="text/css">
                /* 主菜单：垂直居中 + 间距 */
                .menus_items .site-page {
                    display: inline-flex;
                    align-items: center;
                    gap: 0.35em;
                }
                /* 子菜单：垂直居中 + 更大间距（可按需调整） */
                .menus_item_child .site-page {
                    display: inline-flex;
                    align-items: center;
                    gap: 0.6em;
                }
                /* 图标尺寸；要彩色图标就不要写 fill: currentColor */
                .ali_icon {
                    width: 1.2em;
                    height: 1.2em;
                    overflow: hidden;
                    /* fill: currentColor; */
                }
            </style>
        </div>

    </div>
</div>
