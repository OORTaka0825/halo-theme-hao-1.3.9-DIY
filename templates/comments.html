<!DOCTYPE html>
<html lang="zh-CN" xmlns:th="http://www.thymeleaf.org">
  <th:block th:fragment="envelope-comment">

    <!-- 留言信封模块（安全皮肤 + 层级兜底） -->
    <section class="card bbtalk-card envelope-card" style="padding:12px 12px 16px;">

      <th:block th:if="${not #strings.isEmpty(theme.config.envelope_comment.title)}"
                th:utext="${theme.config.envelope_comment.title}"></th:block>

      <style>
        /* 仅对本模块生效的兜底，兼容两种外壳结构 */
        :is(#body-wrap .page, #body-wrap.page) .envelope-card .envelope{ position:relative; z-index:2; }
        @media screen and (max-width: 600px) { #afterimg, #beforeimg { display: none !important } }
        @media screen and (min-width: 600px) {
          .envelope-card #article-container img { margin: 0 auto 0 }
          .envelope-card #form-wrap { overflow: hidden; height: 447px; position: relative; top: 0; transition: all 1s ease-in-out .3s; z-index: 0 }
          .envelope-card #form-wrap:hover { height: [[${theme.config.envelope_comment.height}]]px; top: -200px }
          .envelope-card #beforeimg { position: absolute; bottom: 126px; left: 0; background-repeat: no-repeat; width: 530px; height: 317px; z-index: -100; pointer-events: none }
          .envelope-card #afterimg  { position: absolute; bottom: -2px;   left: 0; background-repeat: no-repeat; width: 530px; height: 259px; z-index: 100;  pointer-events: none }
          .envelope-card #envelope { position: relative; overflow: visible; width: 500px; margin: 0 auto; transition: all 1s ease-in-out .3s; padding-top: 200px }
          .envelope-card #maincontent { width: 530px; margin: 20px auto 0 }
          .envelope-card .formmain { background: #fff; width: 95%; max-width: 800px; margin: auto auto; border-radius: 5px; border: 1px solid; overflow: hidden; -webkit-box-shadow: 0 0 20px 0 #000; box-shadow: 0 0 20px 0 #000 }
        }
        [data-theme=dark] .envelope-card .formmain { background: #323232 }
        [data-theme=dark] .envelope-card .comments { background: #5a5a5a !important }
      </style>

      <div id="article-container">
        <div id="maincontent">
          <div id="form-wrap">
            <img id="beforeimg" class="no-lightbox entered loaded"
                 th:src="@{${theme.config.envelope_comment.custom_pic.beforeimg}}">
            <div id="envelope" class="envelope">
              <form>
                <div class="formmain" style="pointer-events:none">
                  <img class="headerimg no-lightbox entered loaded"
                       th:src="@{${theme.config.envelope_comment.custom_pic.cover}}"
                       style="width:100%;overflow:hidden;pointer-events:none">
                  <div class="comments-main">
                    <h3 class="title3" style="text-decoration:none;color:var(--heo-theme);text-align:center">
                      来自[[${site.title}]]的留言:
                    </h3>
                    <div class="comments"
                         style="text-align:center;border-bottom:#ddd 1px solid;border-left:#ddd 1px solid;padding-bottom:20px;background-color:#eee;margin:15px 0;padding-left:20px;padding-right:20px;border-top:#ddd 1px solid;border-right:#ddd 1px solid;padding-top:20px"
                         th:with="message = ${theme.config.envelope_comment.messageList}">
                      <div th:each="data : ${message}">[[${data.content}]]</div>
                    </div>
                    <div class="bottomcontent" style="text-align:center;margin-top:40px">
                      <img class="bottomimg no-lightbox entered loaded"
                           th:src="@{${theme.config.envelope_comment.custom_pic.line}}"
                           style="width:100%;margin:5px auto 5px auto;display:block;pointer-events:none">
                    </div>
                    <p class="bottomhr" style="font-size:12px;text-align:center;color:#999">
                      [[${theme.config.envelope_comment.bottom}]]
                    </p>
                  </div>
                </div>
              </form>
            </div>
            <img id="afterimg" class="no-lightbox entered loaded"
                 th:src="@{${theme.config.envelope_comment.custom_pic.afterimg}}">
          </div>
        </div>
      </div>
    </section>
  </th:block>
</html>
